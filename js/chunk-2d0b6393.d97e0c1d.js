(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0b6393"],{"1bf2":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("d2-container",[a("template",{slot:"header"},[e.$store.state.d2admin.menu.managerRoleAuthority.has("/admin/managerRole/add")?a("el-button",{attrs:{type:"primary",icon:"el-icon-plus",size:"mini"},on:{click:e.addRole}},[e._v("新增")]):e._e()],1),a("el-table",{attrs:{data:e.rolesList,border:""}},[a("el-table-column",{attrs:{align:"center",label:"角色编号"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.managerRoleId))]}}])}),a("el-table-column",{attrs:{align:"center",label:"角色名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.managerRoleName))]}}])}),a("el-table-column",{attrs:{align:"header-center",label:"创建时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.managerRoleCreateTime))]}}])}),a("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.$store.state.d2admin.menu.managerRoleAuthority.has("/permission/role/edit")?a("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini"},on:{click:function(a){return e.handleEdit(t.row)}}},[e._v("编辑")]):e._e(),e.$store.state.d2admin.menu.managerRoleAuthority.has("/permission/role/del")?a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(a){return e.handleDelete(t.row)}}},[e._v("删除")]):e._e()]}}])})],1),a("el-dialog",{attrs:{visible:e.dialogVisible,title:"edit"===e.dialogType?"编辑":"添加",width:"600px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"80px","label-position":"left"}},[a("el-form-item",{attrs:{label:"角色名",prop:"managerRoleName"}},[a("el-input",{attrs:{placeholder:"请输入角色名"},model:{value:e.ruleForm.managerRoleName,callback:function(t){e.$set(e.ruleForm,"managerRoleName",t)},expression:"ruleForm.managerRoleName"}})],1),a("el-form-item",{attrs:{label:"权限集"}},[a("el-tree",{ref:"tree",attrs:{data:e.permissinList,"show-checkbox":"","node-key":"managerMenuAuthorityTab","check-strictly":e.checkStrictly,props:e.defaultProps}})],1)],1),a("div",{staticStyle:{"text-align":"right"}},[a("el-button",{attrs:{type:"danger"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("确定")])],1)],1),a("template",{slot:"footer"},[e._v("Footer")])],2)},n=[],r=(a("d3b7"),a("96cf"),{managerRoleName:"",managerRoleAuthority:"",managerRoleId:""}),o={name:"Role",data:function(){return{rolesList:[],dialogVisible:!1,ruleForm:Object.assign({},r),dialogType:"",permissinList:[],checkStrictly:!0,defaultProps:{children:"child",label:"managerMenuName"},rules:{managerRoleName:[{required:!0,message:"请输入角色名",trigger:"blur"}]}}},mounted:function(){this.getRoleList()},methods:{getRoleList:function(){var e=this;this.$axios.post("/v1/admin/managerRole/roleList",{}).then((function(t){e.rolesList=t.data}))},addRole:function(){this.dialogType="new",this.dialogVisible=!0,this.ruleForm=Object.assign({},r),this.getPermission()},getPermission:function(){var e=this;this.$axios.post("/v1/admin/managerRole/add",{isAssist:1}).then((function(t){e.permissinList=t.data.managerMenuList,e.$refs.tree.setCheckedKeys([])}))},handleEdit:function(e){var t=this;this.dialogType="edit",this.dialogVisible=!0,this.ruleForm=e,this.getEditPermission(e.managerRoleId),this.$nextTick((function(){t.$refs["ruleForm"].resetFields()}))},getEditPermission:function(e){var t=this;this.$axios.post("/v1/admin/managerRole/edit",{isAssist:1,managerRoleId:e}).then((function(e){t.permissinList=e.data.managerMenuList,t.ruleForm.managerRoleName=e.data.managerRole.managerRoleName,t.ruleForm.managerRoleId=e.data.managerRole.managerRoleId,"ALL"==e.data.managerRole.managerRoleAuthority?t.$refs.tree.setCheckedKeys([]):t.$nextTick((function(){t.$refs.tree.setCheckedKeys(JSON.parse(e.data.managerRole.managerRoleAuthority))}))}))},handleDelete:function(e){var t=this;this.$confirm("确定删除该角色吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return regeneratorRuntime.async((function(a){while(1)switch(a.prev=a.next){case 0:t.$axios.post("/v1/admin/managerRole/del",{managerRoleId:e.managerRoleId}).then((function(e){t.getRoleList(),t.$message.success("删除成功")}));case 1:case"end":return a.stop()}}))}))},submitForm:function(e){var t=this,a={managerRoleName:this.ruleForm.managerRoleName,managerRoleId:this.ruleForm.managerRoleId,managerRoleAuthority:JSON.stringify(this.$refs.tree.getCheckedKeys())};this.$refs[e].validate((function(e){if(!e)return console.log("error submit!!"),!1;"edit"==t.dialogType?t.$axios.post("/v1/admin/managerRole/edit",a).then((function(e){t.dialogVisible=!1,t.getRoleList(),t.$message.success("修改成功")})):t.$axios.post("/v1/admin/managerRole/add",a).then((function(e){t.dialogVisible=!1,t.getRoleList(),t.$message.success("添加成功")}))}))}}},s=o,l=a("2877"),m=function(e){e.options.__source="src/views/authmanage/role.vue"},u=m,d=Object(l["a"])(s,i,n,!1,null,"350e43e4",null);"function"===typeof u&&u(d);t["default"]=d.exports}}]);