(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a26fd89c"],{"61f7":function(e,a,t){"use strict";a["a"]={validatePhone:function(e,a,t){var r=/^[1][3-9][0-9]{9}$/;if(!a)return t(new Error("请输入手机号码"));r.test(a)?t():t(new Error("手机号码格式错误"))}}},e7e6:function(e,a,t){"use strict";t.r(a);var r=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("d2-container",[t("template",{slot:"header"},[e.$store.state.d2admin.menu.managerRoleAuthority.has("/admin/manager/add")?t("el-button",{attrs:{type:"primary",icon:"el-icon-plus",size:"mini"},on:{click:e.handleAdd}},[e._v("新增")]):e._e()],1),t("el-table",{attrs:{data:e.datalist,border:""}},[t("el-table-column",{attrs:{align:"center",label:"用户名"},scopedSlots:e._u([{key:"default",fn:function(a){return[e._v(e._s(a.row.managerUserName))]}}])}),t("el-table-column",{attrs:{align:"center",label:"姓名"},scopedSlots:e._u([{key:"default",fn:function(a){return[e._v(e._s(a.row.managerName))]}}])}),t("el-table-column",{attrs:{align:"center",label:"手机"},scopedSlots:e._u([{key:"default",fn:function(a){return[e._v(e._s(a.row.managerPhoneNumber))]}}])}),t("el-table-column",{attrs:{align:"center",label:"角色名"},scopedSlots:e._u([{key:"default",fn:function(a){return[e._v(e._s(a.row.managerRoleName))]}}])}),t("el-table-column",{attrs:{align:"center",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-tooltip",{attrs:{effect:"dark",content:1==a.row.managerStatus?"启用":"关闭",placement:"top"}},[t("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-value":1,"inactive-value":2,disabled:1==a.row.managerId||e.$store.state.d2admin.menu.managerRoleAuthority.has("/admin/manager/changeStatus")},on:{change:function(t){return e.changestatus(a.row)}},model:{value:a.row.managerStatus,callback:function(t){e.$set(a.row,"managerStatus",t)},expression:"scope.row.managerStatus"}})],1)]}}])}),t("el-table-column",{attrs:{align:"center",label:"注册时间"},scopedSlots:e._u([{key:"default",fn:function(a){return[e._v(e._s(a.row.managerCreateTime))]}}])}),t("el-table-column",{attrs:{align:"center",label:"操作",width:"300"},scopedSlots:e._u([{key:"default",fn:function(a){return[e.$store.state.d2admin.menu.managerRoleAuthority.has("/admin/manager/edit")?t("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini"},on:{click:function(t){return e.handleEdit(a.row)}}},[e._v("编辑")]):e._e(),e.$store.state.d2admin.menu.managerRoleAuthority.has("/admin/manager/del")?t("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(t){return e.handleDelete(a.row)}}},[e._v("删除")]):e._e(),e.$store.state.d2admin.menu.managerRoleAuthority.has("/admin/manager/resetPwd")?t("el-button",{attrs:{type:"success",icon:"el-icon-refresh",size:"mini"},on:{click:function(t){return e.resetpwd(a.row)}}},[e._v("重置密码")]):e._e()]}}])})],1),t("el-dialog",{attrs:{visible:e.dialogVisible,title:"edit"===e.dialogType?"编辑":"添加",width:"600px"},on:{"update:visible":function(a){e.dialogVisible=a}}},[t("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"80px","label-position":"left"}},[t("el-form-item",{attrs:{label:"用户名",prop:"managerUserName"}},[t("el-input",{attrs:{placeholder:"请输入用户名"},model:{value:e.ruleForm.managerUserName,callback:function(a){e.$set(e.ruleForm,"managerUserName",a)},expression:"ruleForm.managerUserName"}})],1),"new"==e.dialogType?t("el-form-item",{attrs:{label:"密码",prop:"managerPassword"}},[t("el-input",{attrs:{placeholder:"请输入密码"},model:{value:e.ruleForm.managerPassword,callback:function(a){e.$set(e.ruleForm,"managerPassword",a)},expression:"ruleForm.managerPassword"}})],1):e._e(),t("el-form-item",{attrs:{label:"姓名",prop:"managerName"}},[t("el-input",{attrs:{placeholder:"请输入姓名"},model:{value:e.ruleForm.managerName,callback:function(a){e.$set(e.ruleForm,"managerName",a)},expression:"ruleForm.managerName"}})],1),t("el-form-item",{attrs:{label:"手机号",prop:"managerPhoneNumber"}},[t("el-input",{attrs:{placeholder:"请输入手机号"},model:{value:e.ruleForm.managerPhoneNumber,callback:function(a){e.$set(e.ruleForm,"managerPhoneNumber",a)},expression:"ruleForm.managerPhoneNumber"}})],1),t("el-form-item",{attrs:{label:"角色",prop:"managerRoleId"}},[t("el-select",{attrs:{placeholder:"请选择角色"},model:{value:e.ruleForm.managerRoleId,callback:function(a){e.$set(e.ruleForm,"managerRoleId",a)},expression:"ruleForm.managerRoleId"}},e._l(e.rolesList,(function(e){return t("el-option",{key:e.managerRoleId,attrs:{label:e.managerRoleName,value:e.managerRoleId}})})),1)],1)],1),t("div",{staticStyle:{"text-align":"right"}},[t("el-button",{attrs:{type:"danger"},on:{click:function(a){e.dialogVisible=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(a){return e.submitForm("ruleForm")}}},[e._v("确定")])],1)],1),t("template",{slot:"footer"},[e._v("Footer")])],2)},n=[],o=(t("d3b7"),t("96cf"),t("61f7")),s={managerUserName:"",managerPassword:"",managerName:"",managerPhoneNumber:"",managerRoleId:"",managerId:""},i={name:"Role",data:function(){return{rolesList:[],dialogType:"",ruleForm:Object.assign({},s),dialogVisible:!1,rules:{managerUserName:[{required:!0,message:"请输入用户名",trigger:"blur"}],managerPassword:[{required:!0,message:"请输入密码",trigger:"blur"}],managerName:[{required:!0,message:"请输入姓名",trigger:"blur"}],managerRoleId:[{required:!0,message:"请选择用户角色",trigger:"change"}],managerPhoneNumber:[{validator:o["a"].validatePhone,trigger:"blur"}]},listQuery:{managerUserName:"",managerRoleId:"",managerStatus:"",managerPhoneNumber:""},datalist:[]}},mounted:function(){this.getdata()},methods:{getdata:function(){var e=this;this.$axios.post("/v1/admin/manager/managerList",this.listQuery).then((function(a){e.datalist=a.data.data}))},changestatus:function(e){var a=this;1===e.managerId?this.$message.error("无法对超级管理员进行操作"):this.$axios.post("/v1/admin/manager/changeStatus",{managerStatus:e.managerStatus,managerId:e.managerId}).then((function(e){a.getdata()}))},handleAdd:function(){var e=this;this.ruleForm=Object.assign({},s),this.dialogType="new",this.dialogVisible=!0,this.getAddAssistdata(),this.$nextTick((function(){e.$refs["ruleForm"].clearValidate()}))},getAddAssistdata:function(){var e=this;this.$axios.post("/v1/admin/manager/add",{isAssist:1}).then((function(a){e.rolesList=a.data.managerRoleList}))},handleEdit:function(e){this.dialogType="edit",this.dialogVisible=!0,this.getEditAssistdata(e.managerId)},getEditAssistdata:function(e){var a=this;this.$axios.post("/v1/admin/manager/edit",{isAssist:1,managerId:e}).then((function(e){a.rolesList=e.data.managerRoleList,a.ruleForm=e.data.manager}))},handleDelete:function(e){var a=this;this.$confirm("确定删除该用户吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return regeneratorRuntime.async((function(t){while(1)switch(t.prev=t.next){case 0:a.$axios.post("/v1/admin/manager/del",{managerId:e.managerId}).then((function(e){a.getdata(),a.$message.success("删除成功")}));case 1:case"end":return t.stop()}}))}))},resetpwd:function(e){var a=this;this.$prompt("请输入新密码","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(t){var r=t.value;a.$axios.post("/v1/admin/manager/resetPwd",{managerId:e.managerId,managerPassword:r}).then((function(e){a.$message.success("重置密码成功")}))})).catch((function(){a.$message({type:"info",message:"取消输入"})}))},submitForm:function(e){var a=this;this.$refs[e].validate((function(e){if(!e)return console.log("error submit!!"),!1;"edit"==a.dialogType?a.$axios.post("/v1/admin/manager/edit",a.ruleForm).then((function(e){a.getdata(),a.dialogVisible=!1,a.$message.success("修改成功")})):a.$axios.post("/v1/admin/manager/add",a.ruleForm).then((function(e){a.getdata(),a.dialogVisible=!1,a.$message.success("添加成功")}))}))}}},l=i,m=t("2877"),u=function(e){e.options.__source="src/views/authmanage/user.vue"},d=u,c=Object(m["a"])(l,r,n,!1,null,"053c6c39",null);"function"===typeof d&&d(c);a["default"]=c.exports}}]);