(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-47d2872f"],{"700a":function(t,e,a){"use strict";var r=a("b0aa"),o=a.n(r);o.a},b0aa:function(t,e,a){},c0b3:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("d2-container",[a("template",{slot:"header"},[a("div",{staticClass:"pageHeader"},[a("el-button",{attrs:{type:"primary",icon:"el-icon-plus",size:"small"},on:{click:t.handleAdd}},[t._v("新增")]),a("el-input",{staticClass:"search-input",attrs:{placeholder:"商品名称",clearable:""},model:{value:t.listQuery.productName,callback:function(e){t.$set(t.listQuery,"productName",e)},expression:"listQuery.productName"}}),a("el-select",{staticStyle:{margin:"0 10px"},attrs:{clearable:"",placeholder:"请选择状态"},model:{value:t.listQuery.productStatus,callback:function(e){t.$set(t.listQuery,"productStatus",e)},expression:"listQuery.productStatus"}},t._l(t.statusList,(function(t,e){return a("el-option",{key:e,attrs:{label:t.label,value:t.value}})})),1),a("el-button",{attrs:{type:"success",icon:"el-icon-search",size:"small"},on:{click:t.getdata}},[t._v("搜索")])],1)]),a("el-table",{attrs:{data:t.dataList,border:""}},[a("el-table-column",{attrs:{prop:"productName",label:"产品名称"}}),a("el-table-column",{attrs:{label:"图片",width:"140",align:"center"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("img",{staticStyle:{width:"8vw",height:"8vw"},attrs:{src:t.row.productImagePath,alt:""}})]}}])}),a("el-table-column",{attrs:{prop:"productDescription",label:"产品简介"}}),a("el-table-column",{attrs:{label:"分类"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t.categoryData[e.row.productCategoryId])+" ")]}}])}),a("el-table-column",{attrs:{prop:"productPrice",label:"产品价格"}}),a("el-table-column",{attrs:{prop:"productStock",label:"库存"}}),a("el-table-column",{attrs:{prop:"productSalesVolume",label:"实际销量"}}),a("el-table-column",{attrs:{prop:"productVirtualSalesVolume",label:"虚拟销量"}}),a("el-table-column",{attrs:{align:"center",label:"状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:1==e.row.productStatus?"上架":"下架",placement:"top"}},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-value":1,"inactive-value":2},on:{change:function(a){return t.changeStatus(a,e.row)}},model:{value:e.row.productStatus,callback:function(a){t.$set(e.row,"productStatus",a)},expression:"scope.row.productStatus"}})],1)]}}])}),a("el-table-column",{attrs:{prop:"productAttributes",label:"参数"}}),a("el-table-column",{attrs:{label:"操作",width:"160",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.$store.state.d2admin.menu.managerRoleAuthority.has("/admin/productCategory/edit")?a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(a){return t.handleEdit(e.row)}}},[t._v("编辑")]):t._e(),t.$store.state.d2admin.menu.managerRoleAuthority.has("/admin/productCategory/del")?a("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(a){return t.handleDel(e.row)}}},[t._v("删除")]):t._e()]}}])})],1),a("el-dialog",{attrs:{title:t.edittitle,visible:t.dialogVisible,width:"50%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:t.ruleForm,rules:t.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"名称",prop:"productName"}},[a("el-input",{model:{value:t.ruleForm.productName,callback:function(e){t.$set(t.ruleForm,"productName",e)},expression:"ruleForm.productName"}})],1),a("el-form-item",{attrs:{label:"图片",prop:"productImageId"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:t.action,"show-file-list":!1,"on-success":t.handleSuccess,data:t.uploadOtherParmas,name:"product_image"}},[t.imageUrl?a("img",{staticClass:"avatar",attrs:{src:t.imageUrl}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"}),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("建议上传宽高为1:1的图片")])])],1),a("el-form-item",{attrs:{label:"分类"}},[a("el-select",{attrs:{placeholder:"请选择分类"},model:{value:t.ruleForm.productCategoryId,callback:function(e){t.$set(t.ruleForm,"productCategoryId",e)},expression:"ruleForm.productCategoryId"}},t._l(t.categoryList,(function(t,e){return a("el-option",{key:e,attrs:{label:t.categoryName,value:t.categoryId}})})),1)],1),a("el-form-item",{attrs:{label:"描述",prop:"productDescription"}},[a("el-input",{model:{value:t.ruleForm.productDescription,callback:function(e){t.$set(t.ruleForm,"productDescription",e)},expression:"ruleForm.productDescription"}})],1),a("el-form-item",{attrs:{label:"价格",prop:"productPrice"}},[a("el-input",{model:{value:t.ruleForm.productPrice,callback:function(e){t.$set(t.ruleForm,"productPrice",e)},expression:"ruleForm.productPrice"}})],1),a("el-form-item",{attrs:{label:"库存",prop:"productStock"}},[a("el-input",{model:{value:t.ruleForm.productStock,callback:function(e){t.$set(t.ruleForm,"productStock",e)},expression:"ruleForm.productStock"}})],1),a("el-form-item",{attrs:{label:"虚拟销量",prop:"productVirtualSalesVolume"}},[a("el-input",{model:{value:t.ruleForm.productVirtualSalesVolume,callback:function(e){t.$set(t.ruleForm,"productVirtualSalesVolume",e)},expression:"ruleForm.productVirtualSalesVolume"}})],1),a("el-form-item",{attrs:{label:"参数"}},[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入参数名"},model:{value:t.attributeName,callback:function(e){t.attributeName=e},expression:"attributeName"}},[a("el-button",{attrs:{slot:"append"},on:{click:t.addAttribute},slot:"append"},[t._v("添加")])],1)],1),t.attributeList.length>0?a("el-form-item",{attrs:{label:"参数内容"}},t._l(t.attributeList,(function(e,r){return a("el-input",{key:r,attrs:{placeholder:"请输入参数内容"},model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"item.value"}},[a("template",{slot:"prepend"},[t._v(t._s(e.key))]),a("el-button",{attrs:{slot:"append"},on:{click:function(e){return t.removeAttribute(r)}},slot:"append"},[t._v("移除")])],2)})),1):t._e()],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitForm("ruleForm")}}},[t._v("确 定")])],1)],1),a("template",{slot:"footer"},[a("pagination",{attrs:{total:t.total,page:t.listQuery.page,limit:t.listQuery.limit},on:{"update:page":function(e){return t.$set(t.listQuery,"page",e)},"update:limit":function(e){return t.$set(t.listQuery,"limit",e)},pagination:t.getdata}})],1)],2)},o=[],l=(a("a4d3"),a("e01a"),a("d28b"),a("99af"),a("a434"),a("d3b7"),a("3ca3"),a("1276"),a("ddb0"),a("2b3d"),a("333d")),i=a("c276"),s={productName:"",productDescription:"",productCategoryId:"",productPrice:"",productStock:"",productImageId:"",productVirtualSalesVolume:"",productAttributes:"",productId:""},u={name:"GoodsList",data:function(){return{listQuery:{limit:10,page:1,productName:"",productStatus:""},total:10,action:"",imageUrl:"",uploadOtherParmas:{isUploadImage:1,token:i["a"].cookies.get("token")},dataList:[],ruleForm:Object.assign({},s),rules:{productName:[{required:!0,message:"请输入商品名称",trigger:"blur"}],productImageId:[{required:!0,message:"请上传图片",trigger:"blur"}],productDescription:[{required:!0,message:"请输入商品描述",trigger:"blur"}],productCategoryId:[{required:!0,message:"请选择分类",trigger:"blur"}],productPrice:[{required:!0,message:"请输入商品价格",trigger:"blur"}],productStock:[{required:!0,message:"请输入库存",trigger:"blur"}]},edittitle:"",dialogVisible:!1,statusList:[{value:0,label:"全部"},{value:1,label:"上架"},{value:2,label:"下架"}],categoryData:{},categoryList:[],attributeName:"",attributeList:[]}},components:{Pagination:l["a"]},mounted:function(){this.getassistdata(),this.getdata()},methods:{getassistdata:function(){var t=this;this.$store.dispatch("mystore/mystore/GETASSISTDATA",{data:{isAssist:1},url:"/v1/admin/product/productList"}).then((function(e){t.categoryData={};var a=!0,r=!1,o=void 0;try{for(var l,i=e.data.categoryList[Symbol.iterator]();!(a=(l=i.next()).done);a=!0){var s=l.value;t.categoryData[s.categoryId]=s.categoryName}}catch(u){r=!0,o=u}finally{try{a||null==i.return||i.return()}finally{if(r)throw o}}}))},getdata:function(){var t=this;this.$axios.post("/v1/admin/product/productList",this.listQuery).then((function(e){t.total=e.data.total,t.dataList=e.data.data}))},handleAdd:function(){var t=this;this.edittitle="新增",this.dialogVisible=!0,this.ruleForm=Object.assign({},s),this.action=window.apiObj.ApiUrl+"/v1/admin/product/add",this.imageUrl="",this.attributeList=[],this.$store.dispatch("mystore/mystore/GETASSISTDATA",{data:{isAssist:1},url:"/v1/admin/product/add"}).then((function(e){t.categoryList=e.data.categoryList}))},handleSuccess:function(t,e){this.imageUrl=URL.createObjectURL(e.raw),this.ruleForm.productImageId=t.data.image_id},handleEdit:function(t){var e=this;this.edittitle="编辑",this.dialogVisible=!0,this.action=window.apiObj.ApiUrl+"/v1/admin/product/edit",this.$store.dispatch("mystore/mystore/GETASSISTDATA",{data:{isAssist:1,productId:t.productId},url:"/v1/admin/product/edit"}).then((function(t){e.categoryList=t.data.categoryList,e.ruleForm=t.data.product,e.imageUrl=t.data.product.productImagePath;var a=t.data.product.productAttributes.split(",");e.attributeList=[];var r=!0,o=!1,l=void 0;try{for(var i,s=a[Symbol.iterator]();!(r=(i=s.next()).done);r=!0){var u=i.value,c={key:u.split(":")[0],value:u.split(":")[1]};e.attributeList.push(c)}}catch(n){o=!0,l=n}finally{try{r||null==s.return||s.return()}finally{if(o)throw l}}}))},changeStatus:function(t,e){var a=this;this.$axios.post("/v1/admin/product/changeStatus",{productId:e.productId}).then((function(t){a.$message.success("更改状态成功"),a.getdata()}))},addAttribute:function(){""==this.attributeName?this.$message("请输入属性名"):(this.attributeList.push({key:this.attributeName,value:""}),this.attributeName="")},removeAttribute:function(t){this.attributeList.splice(t,1)},submitForm:function(t){var e=this;this.ruleForm.productAttributes="";var a=!0,r=!1,o=void 0;try{for(var l,i=this.attributeList[Symbol.iterator]();!(a=(l=i.next()).done);a=!0){var s=l.value;this.ruleForm.productAttributes+="".concat(s.key,":").concat(s.value,",")}}catch(u){r=!0,o=u}finally{try{a||null==i.return||i.return()}finally{if(r)throw o}}this.ruleForm.productAttributes=this.ruleForm.productAttributes.substr(0,this.ruleForm.productAttributes.length-1),this.$refs[t].validate((function(t){if(!t)return!1;"编辑"==e.edittitle?e.$axios.post("/v1/admin/product/edit",e.ruleForm).then((function(t){e.$message.success("修改成功"),e.getdata(),e.dialogVisible=!1})):e.$axios.post("/v1/admin/product/add",e.ruleForm).then((function(t){e.$message.success("新增成功"),e.getdata(),e.dialogVisible=!1}))}))},handleDel:function(t){var e=this;this.$store.dispatch("mystore/mystore/DELETEROWDATA",{data:{productId:t.productId},url:"/v1/admin/product/del"}).then((function(t){e.getdata()}))}}},c=u,n=(a("700a"),a("2877")),d=function(t){t.options.__source="src/views/demo.vue"},p=d,m=Object(n["a"])(c,r,o,!1,null,"082ca3cd",null);"function"===typeof p&&p(m);e["default"]=m.exports}}]);